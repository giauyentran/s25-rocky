clear all

motor_calib = [
    0.00,0.00; 0.13,0.15; 0.41,0.45; 0.55,0.58; 0.62,0.63; 0.61,0.62; 
    0.71,0.71; 0.66,0.68; 0.72,0.77; 0.61,0.71; 0.71,0.79; 0.61,0.72; 
    0.70,0.79; 0.59,0.71; 0.71,0.80; 0.66,0.73; 0.71,0.81; 0.75,0.82; 
    0.73,0.82; 0.68,0.75; 0.77,0.81; 0.71,0.73; 0.80,0.80; 0.72,0.75; 
    0.81,0.82; 0.70,0.76; 0.75,0.84; 0.71,0.75; 0.80,0.82; 0.73,0.75; 
    0.80,0.84; 0.70,0.77; 0.75,0.84; 0.71,0.76; 0.80,0.85; 0.73,0.77; 
    0.77,0.86; 0.68,0.77; 0.79,0.84; 0.73,0.76; 0.77,0.85; 0.70,0.79; 
    0.80,0.86; 0.80,0.86; 0.80,0.86; 0.68,0.80; 0.80,0.85; 0.73,0.76; 
    0.77,0.86; 0.70,0.79; 0.80,0.88; 0.73,0.80; 0.76,0.86; 0.71,0.77; 
    0.81,0.84; 0.72,0.77; 0.76,0.86; 0.72,0.79; 0.81,0.86; 0.77,0.85; 
    0.77,0.86; 0.72,0.76; 0.80,0.84; 0.70,0.77; 0.76,0.86; 0.72,0.77; 
    0.81,0.85; 0.73,0.79; 0.79,0.85; 0.72,0.77; 0.75,0.79; 0.82,0.86; 
    0.73,0.79; 0.82,0.85; 0.82,0.85; 0.82,0.85; 0.75,0.77; 0.82,0.86; 
    0.75,0.79; 0.82,0.88; 0.76,0.79; 0.84,0.86; 0.76,0.76; 0.84,0.85; 
    0.76,0.79; 0.85,0.86; 0.77,0.79; 0.85,0.86; 0.85,0.85; 0.85,0.85; 
    0.77,0.79; 0.86,0.86; 0.77,0.80; 0.85,0.88; 0.79,0.80; 0.86,0.86; 
    0.77,0.77; 0.86,0.85; 0.79,0.79; 0.86,0.86; 0.79,0.80; 0.86,0.88; 
    0.79,0.79; 0.86,0.85; 0.86,0.86; 0.88,0.86; 0.79,0.79; 0.88,0.88; 
    0.80,0.80; 0.86,0.88; 0.80,0.79; 0.88,0.85; 0.80,0.79; 0.86,0.86; 
    0.79,0.80; 0.86,0.88; 0.77,0.79; 0.85,0.85; 0.86,0.85; 0.86,0.86; 
    0.79,0.79; 0.88,0.86;
    ];

l_motor = motor_calib(:,1);
r_motor = motor_calib(:,2);
time = 0:0.02:3;
time = time(1:122);

both_motors = [l_motor, r_motor];
both_time = [time.', time.'];

% From cftool
K = 0.0027;
tau = 0.0644;

figure
hold on
plot(time.', r_motor, '.b')
plot(time.', l_motor, '.r')
fplot(@(x) 300*K*(1-exp(-x/tau)), '-k')
xlim([0 2.6])

xlabel("Time (s)")
ylabel("Velocity (m/s)")
title("Motor Calibration")
legend("Right Motor Data", "Left Motor Data", "Curve Fit","Location",'southeast')

